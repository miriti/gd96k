<!DOCTYPE html><html><style>html,head{margin:0px;padding:0px;background-color:#333;}#c{width:800px;margin-right:auto;margin-left:auto;}</style><body><div id="c"></div><script>'use strict';var d={},f="1c1c1c 393939 565656 727272 8f8f8f adadad cacaca e6e6e6".split(" ");function h(a,b){null!==b&&(a.prototype=Object.create(b.prototype));a.prototype.constructor=a}var k=0,k=(new Date).getTime(),l=Array(256);function m(a,b){this.x=a;this.y=b}h(m,null);m.prototype.set=function(a,b){this.x=a;this.y=b};function n(){this.ch=[];this.rotation=this.y=this.x=0;this.scale=new m(1,1);this.parent=null;this.visible=!0;this.height=this.width=0}h(n,null);
n.prototype.rect=function(a,b,c,e,g,t){a.fillStyle="#"+t;a.strokeStyle="#000";a.lineWidth=1;a.fillRect(b,c,e,g)};n.prototype.add=function(a){this.ch.push(a);a.parent=this};n.prototype.v=function(a){a=this.ch.indexOf(a);-1!=a&&(this.ch[a].parent=null,this.ch.splice(a,1))};n.prototype.update=function(a){for(var b=this.ch.length-1;0<=b;b--)this.ch[b].update(a)};
n.prototype.h=function(a){if(this.visible&&(a.translate(this.x,this.y),a.scale(this.scale.x,this.scale.y),a.rotate(this.rotation),0<this.ch.length))for(var b in this.ch)a.save(),this.ch[b].h(a),a.restore()};function p(a,b,c,e){n.call(this);this.width=a||100;this.height=b||100;this.color=c||f[0];this.B=e||new m(0,0)}h(p,n);p.prototype.h=function(a){n.prototype.h.call(this,a);this.rect(a,-this.B.x,-this.B.y,this.width,this.height,this.color)};
function q(a){this.c=a;this.e=2*Math.random()*Math.PI;this.i=this.time=0;this.loop=!0}h(q,null);q.prototype.update=function(a){if(!this.loop&&this.time>=this.i){var b=this.c;0<b.q.length&&r(b,b.q.pop())}this.e+=Math.PI*a;this.time+=a;!this.loop&&this.time>this.i&&(this.time=this.i)};function s(a){q.call(this,a);a.b.d.x=-8;a.b.d.y=-0;a.b.f.x=8;a.b.f.y=-0;a.a.j.rotation=Math.PI/2;a.a.o.rotation=Math.PI/2;a.a.rotation=0}h(s,q);
s.prototype.update=function(a){q.prototype.update.call(this,a);this.c.a.y=3+3*Math.sin(this.e)};function u(a){q.call(this,a);a.a.y=0;a.a.rotation=Math.PI/12}u.prototype.update=function(a){q.prototype.update.call(this,a);this.c.b.d.y=-4+4*Math.cos(10*this.e);this.c.b.f.y=-4+4*Math.sin(10*this.e);this.c.a.j.rotation=Math.PI/2-Math.sin(5*this.e);this.c.a.o.rotation=Math.PI/2+Math.sin(5*this.e)};
function w(a){q.call(this,a);this.i=.2;this.loop=!1;a.b.d.x=-8;a.b.d.y=-0;a.b.f.x=8;a.b.f.y=-0;this.s=null;this.s=.5<Math.random()?a.a.j:a.a.o;this.s.rotation=0;this.w=Math.PI/16;a.a.rotation=this.w}w.prototype.update=function(a){q.prototype.update.call(this,a);this.c.a.rotation=d.C.F(this.w,0,this.time,this.i);this.s.rotation=d.C.F(0,Math.PI/2,this.time,this.i)};
function x(){n.call(this);this.a=new n;this.a.o=new p(40,6,f[4],new m(0,3));this.a.o.y=-45;this.a.add(this.a.o);this.a.body=new p(30,60,f[6],new m(15,60));this.a.add(this.a.body);this.a.head=new p(15,30,f[7],new m(7.5,30));this.a.head.y=-60;this.a.add(this.a.head);this.a.j=new p(50,6,f[7],new m(0,3));this.a.j.x=0;this.a.j.y=-50;this.a.add(this.a.j);this.b=new n;this.b.d=new p(8,50,f[7],new m(4,0));this.b.d.x=-8;this.b.add(this.b.d);this.b.f=new p(8,50,f[7],new m(4,0));this.b.f.x=8;this.b.add(this.b.f);
this.add(this.b);this.add(this.a);this.q=[];this.l=null;this.g="";r(this,"Idle")}h(x,n);function r(a,b){if(a.g!=b){switch(b){case "Idle":a.l=new s(a);break;case "Running":a.l=new u(a);break;case "Hit":a.l=new w(a)}""!=a.g&&a.q.push(a.g);a.g=b}}x.prototype.update=function(a){null!==this.l&&this.l.update(a)};function y(){n.call(this);this.n=100;this.p=!1;this.D=150;this.r=0;this.width=50;this.height=100;this.speed=300;this.c=new x;this.c.y=-50;this.add(this.c)}h(y,n);
y.prototype.update=function(a){n.prototype.update.call(this,a);for(var b in this.parent.A){var c=this.parent.A[b],e=this.x-c.x,g=this.y-c.y;Math.abs(e)<c.width/2&&Math.abs(g)<c.height/2&&(c.width/2-Math.abs(e)<c.height/2-Math.abs(g)?this.x=this.x>c.x?this.x+(c.width/2-e):this.x-(c.width/2+e):this.y=this.y>c.y?this.y+(c.height/2-g):this.y-(c.height/2+g))}this.p&&(1.5>this.r?(this.visible=0===Math.floor(k/this.D)%2,this.r+=a):this.parent.v(this))};function z(){y.call(this)}h(z,y);
function A(){y.call(this);this.t=!1}h(A,y);
A.prototype.update=function(a){if("Hit"!=this.c.g){var b=!1;l[37]&&(this.scale.set(-1,1),this.x-=this.speed*a,b=!0);l[39]&&(this.x+=this.speed*a,this.scale.set(1,1),b=!0);l[38]&&(this.y-=this.speed*a,b=!0);l[40]&&(this.y+=this.speed*a,b=!0);b?r(this.c,"Running"):r(this.c,"Idle")}if(l[90]){if(!this.t&&"Hit"!=this.c.g)for(r(this.c,"Hit"),this.t=!0,b=0;b<this.parent.m.length;b++){var c=this.parent.m[b];c!=this&&!c.p&&Math.abs(c.x-this.x)<(this.width+c.width)/2&&Math.abs(c.y-this.y)<(this.height+c.height)/
2&&(c.n-=10,0>c.n&&(c.n=0),0!==c.n||c.p||(c.p=!0))}}else this.t=!1;y.prototype.update.call(this,a)};h(function(a,b,c,e){this.x=a||0;this.y=b||0;this.width=c||10;this.height=e||10},null);function B(){n.call(this);this.m=[];this.A=[];this.u=new A}h(B,n);B.prototype.add=function(a){n.prototype.add.call(this,a);a instanceof y&&this.m.push(a)};B.prototype.v=function(a){n.prototype.v.call(this,a);a=this.m.indexOf(a);-1!=a&&this.m.splice(a,1)};
function C(){B.call(this);this.u.x=400;this.u.y=300;this.add(this.u);var a=new z;a.x=300;a.y=300;this.add(a)}h(C,B);function D(){this.k=null}h(D,null);function E(a){var b=new C;a.k=b}D.prototype.update=function(a){null!==this.k&&this.k.update(a)};D.prototype.h=function(a){null!==this.k&&this.k.h(a)};
(function(a,b){function c(){var a=k=(new Date).getTime(),b=(a-t)/1E3;t=a;g.setTransform(1,0,0,1,0,0);g.fillStyle=f[0];g.fillRect(0,0,800,600);if(.02<b){do v.update(.02),b-=.02;while(.02<b)}v.update(b);v.h(g);requestAnimationFrame(c)}var e=a.createElement("canvas"),g=e.getContext("2d"),t=k,v=new D;e.width=800;e.height=600;a.getElementById("c").appendChild(e);b.addEventListener("keydown",function(a){if("undefined"==typeof l[a.keyCode]||null===l[a.keyCode])l[a.keyCode]=k});b.addEventListener("keyup",
function(a){l[a.keyCode]=null});E(v);c()})(document,window);
</script></body></html>